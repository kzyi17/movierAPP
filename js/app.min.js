/**
 * 系统设置，用户相关
 *  
 * 
 **/var APP_NAME="\u5f71\u4eba\u6839\u636e\u5730";(function(d,b){b.appInit=function(){console.log("appInit....");b.getGeo(function(a){var c={},d=b.getCurrentCity();c.province=a.address.province;c.city=a.address.city;c.district=a.address.district;c.address=a.addresses;c.lng=a.coords.longitude;c.lat=a.coords.latitude;c.timestamp=a.timestamp;b.setCurrentPosition(c);"undefined"==typeof d.name&&(c={},c.name=a.address.city,c.code=a.address.cityCode,b.setCurrentCity(c));var e=a.address.city;d.name!==e&&plus.nativeUI.confirm("\u7cfb\u7edf\u5b9a\u4f4d\u5230\u60a8\u5728"+e+"\uff0c\u9700\u8981\u5207\u6362\u5230"+e+"\u5417\uff1f",function(a){0==a.index&&(b.setCurrentCity({name:e}),mui.fire(plus.webview.getLaunchWebview(),"changCity"),console.log("\u5f53\u524d\u57ce\u5e02\uff1a"+e))},"",["\u5207\u6362","\u4e0d\u4e86"])})};b.getGeo=function(a,c,f,e){a=a||d.noop;c=c||d.noop;f=e?e:5;plus.geolocation.getCurrentPosition(function(b){a(b)},function(e){f--;if(0<f)return d.toast("\u83b7\u53d6\u4f4d\u7f6e\u5931\u8d25\uff0c\u6b63\u5728\u91cd\u65b0\u83b7\u53d6..."),b.getGeo(a,c,f);c();d.alert("\u65e0\u6cd5\u83b7\u53d6\u60a8\u7684\u4f4d\u7f6e");console.log("\u83b7\u53d6\u5b9a\u4f4d\u4f4d\u7f6e\u4fe1\u606f\u5931\u8d25\uff1a"+e.message)},{geocode:!0,provider:"amap"})};b.getCurrentCity=function(){var a=localStorage.getItem("$currentCity")||"{}";return JSON.parse(a)};b.setCurrentCity=function(a){a=a||{};localStorage.setItem("$currentCity",JSON.stringify(a))};b.getCurrentPosition=function(){var a=localStorage.getItem("$currentPosition")||"{}";return JSON.parse(a)};b.setCurrentPosition=function(a){a=a||{};localStorage.setItem("$currentPosition",JSON.stringify(a))};b.getState=function(){var a=localStorage.getItem("$movier_state")||"{}";return JSON.parse(a)};b.setState=function(a){a=a||{};localStorage.setItem("$movier_state",JSON.stringify(a))};b.getUserId=function(){return(b.getState().userInfo||"{}").user_id};b.clearState=function(a){a={};localStorage.setItem("$movier_state",JSON.stringify(a))};b.checkLogin=function(){return b.getState().userId?!0:!1};b.loginAuth=function(a){a=a||d.noop;b.getState().userId?a():d.alert("\u60a8\u8fd8\u672a\u767b\u5f55,\u8bf7\u5148\u767b\u5f55","\u5f71\u4eba\u6839\u636e\u5730","\u786e\u5b9a",function(){d.openWindow({url:"login.html",id:"login",show:{aniShow:"slide-in-bottom"}})})}})(mui,window.App={});