/*
 * Binary Ajax 0.1.10
 * Copyright (c) 2008 Jacob Seidelin, jseidelin@nihilogic.dk, http://blog.nihilogic.dk/
 * Licensed under the MPL License [http://www.nihilogic.dk/licenses/mpl-license.txt]
 */var BinaryFile=function(l,k,h){var d=l,g=k||0,e=0;this.getRawData=function(){return d};"string"==typeof l?(e=h||d.length,this.getByteAt=function(a){return d.charCodeAt(a+g)&255},this.getBytesAt=function(a,f){for(var c=[],b=0;b<f;b++)c[b]=d.charCodeAt(a+b+g)&255;return c}):"unknown"==typeof l&&(e=h||IEBinary_getLength(d),this.getByteAt=function(a){return IEBinary_getByteAt(d,a+g)},this.getBytesAt=function(a,f){return(new VBArray(IEBinary_getBytesAt(d,a+g,f))).toArray()});this.getLength=function(){return e};this.getSByteAt=function(a){a=this.getByteAt(a);return 127<a?a-256:a};this.getShortAt=function(a,f){var c=f?(this.getByteAt(a)<<8)+this.getByteAt(a+1):(this.getByteAt(a+1)<<8)+this.getByteAt(a);0>c&&(c+=65536);return c};this.getSShortAt=function(a,f){var c=this.getShortAt(a,f);return 32767<c?c-65536:c};this.getLongAt=function(a,f){var c=this.getByteAt(a),b=this.getByteAt(a+1),d=this.getByteAt(a+2),e=this.getByteAt(a+3),c=f?(((c<<8)+b<<8)+d<<8)+e:(((e<<8)+d<<8)+b<<8)+c;0>c&&(c+=4294967296);return c};this.getSLongAt=function(a,d){var c=this.getLongAt(a,d);return 2147483647<c?c-4294967296:c};this.getStringAt=function(a,d){for(var c=[],b=this.getBytesAt(a,d),e=0;e<d;e++)c[e]=String.fromCharCode(b[e]);return c.join("")};this.getCharAt=function(a){return String.fromCharCode(this.getByteAt(a))};this.toBase64=function(){return window.btoa(d)};this.fromBase64=function(a){d=window.atob(a)}},BinaryAjax=function(){function l(){var d=null;window.ActiveXObject?d=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest&&(d=new XMLHttpRequest);return d}function k(d,g,e){var a=l();a?(g&&("undefined"!=typeof a.onload?a.onload=function(){"200"==a.status?g(this):e&&e();a=null}:a.onreadystatechange=function(){4==a.readyState&&("200"==a.status?g(this):e&&e(),a=null)}),a.open("HEAD",d,!0),a.send(null)):e&&e()}function h(d,g,e,a,f,c){var b=l();if(b){var h=0;a&&!f&&(h=a[0]);var k=0;a&&(k=a[1]-a[0]+1);g&&("undefined"!=typeof b.onload?b.onload=function(){"200"==b.status||"206"==b.status||"0"==b.status?(b.binaryResponse=new BinaryFile(b.responseText,h,k),b.fileSize=c||b.getResponseHeader("Content-Length"),g(b)):e&&e();b=null}:b.onreadystatechange=function(){if(4==b.readyState){if("200"==b.status||"206"==b.status||"0"==b.status){var a={status:b.status,binaryResponse:new BinaryFile("unknown"==typeof b.responseBody?b.responseBody:b.responseText,h,k),fileSize:c||b.getResponseHeader("Content-Length")};g(a)}else e&&e();b=null}});b.open("GET",d,!0);b.overrideMimeType&&b.overrideMimeType("text/plain; charset\x3dx-user-defined");a&&f&&b.setRequestHeader("Range","bytes\x3d"+a[0]+"-"+a[1]);b.setRequestHeader("If-Modified-Since","Sat, 1 Jan 1970 00:00:00 GMT");b.send(null)}else e&&e()}return function(d,g,e,a){a?k(d,function(f){var c=parseInt(f.getResponseHeader("Content-Length"),10);f=f.getResponseHeader("Accept-Ranges");var b;b=a[0];0>a[0]&&(b+=c);h(d,g,e,[b,b+a[1]-1],"bytes"==f,c)}):h(d,g,e)}}();document.write("\x3cscript type\x3d'text/vbscript'\x3e\r\nFunction IEBinary_getByteAt(strBinary, iOffset)\r\n\tIEBinary_getByteAt \x3d AscB(MidB(strBinary, iOffset + 1, 1))\r\nEnd Function\r\nFunction IEBinary_getBytesAt(strBinary, iOffset, iLength)\r\n  Dim aBytes()\r\n  ReDim aBytes(iLength - 1)\r\n  For i \x3d 0 To iLength - 1\r\n   aBytes(i) \x3d IEBinary_getByteAt(strBinary, iOffset + i)\r\n  Next\r\n  IEBinary_getBytesAt \x3d aBytes\r\nEnd Function\r\nFunction IEBinary_getLength(strBinary)\r\n\tIEBinary_getLength \x3d LenB(strBinary)\r\nEnd Function\r\n\x3c/script\x3e\r\n");